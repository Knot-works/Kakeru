# 素材インポート機能（検討中）

## 概要

ユーザーが英語の記事、歌詞、詩などを自由にペーストし、それを教材として対話形式で学習できる機能。

## この機能が強い理由

### 1. 興味駆動の学習

- 好きなアーティストの歌詞、気になるニュース記事
- 教科書的な例文より圧倒的にモチベーションが違う
- 自分ごととして学べるため、記憶に残りやすい

### 2. 既存機能との親和性が高い

- 結果画面の「テキスト選択→質問」機能（`SelectionPopover` + `ChatPanel`）がそのまま再利用可能
- 単語帳への登録機能も既に実装済み
- 技術的な追加コストが低い

### 3. 競合との差別化

| サービス | 特徴 | 限界 |
|---------|------|------|
| DeepL / Google翻訳 | 翻訳するだけ | 学習にならない |
| ChatGPT | 汎用的 | 英語学習に特化していない |
| **Kakeru** | 英語学習の文脈で回答 | - |

Kakeruならではの価値：
- 「なぜこの表現が使われている？」
- 「他の言い方はある？」
- 「このニュアンスは？」
- 「この文法構造を解説して」

## MVP設計

### ユーザーフロー

```
新ページ「素材で学ぶ」
        ↓
テキストエリアに英文をペースト
        ↓
「学習する」ボタンで確定
        ↓
学習画面へ遷移
```

### 学習画面のレイアウト

```
┌─────────────────────────────────────────────────────┐
│  素材で学ぶ                              [単語帳へ] │
├────────────────────────────┬────────────────────────┤
│                            │                        │
│  ペーストしたテキスト表示    │    チャットパネル       │
│                            │                        │
│  テキスト選択 →             │    質問を入力...        │
│    質問ポップオーバー表示    │                        │
│                            │                        │
│  気になる表現をタップ →      │    AIが英語学習の       │
│    単語帳に追加             │    文脈で回答           │
│                            │                        │
└────────────────────────────┴────────────────────────┘
```

### 再利用するコンポーネント

- `SelectionPopover` - テキスト選択時のポップオーバー
- `ChatPanel` - 質問・回答のチャットUI
- 単語帳登録機能 - `saveVocab`

### 新規実装が必要なもの

- 素材入力ページ（`/learn` or `/material`）
- 学習画面ページ
- 素材のコンテキストを保持するCloud Function（既存の `askFollowUp` を拡張）

## サービスの軸について

「ライティング」から少し広がるが、**「英語で表現する力を鍛える」** という軸で捉えれば一貫性を保てる。

### インプット・アウトプットのサイクル

```
┌─────────────────────────────────────────────┐
│                                             │
│   インプット（読んで吸収）                    │
│   └─ 素材インポート機能 ← NEW               │
│           ↓                                 │
│   アウトプット（書いて使う）                  │
│   └─ ライティング練習（既存）                │
│           ↓                                 │
│   フィードバック（修正）                     │
│   └─ 添削機能（既存）                       │
│           ↓                                 │
│   定着（繰り返し）                          │
│   └─ 間違いノート・単語帳（既存）            │
│                                             │
└─────────────────────────────────────────────┘
```

両方あった方がサイクルが回って、学習効果が高まる。

## 懸念点

### 著作権

- 歌詞は特に厳しい（JASRAC等）
- ユーザーが個人利用目的でペーストする形なら問題は軽減
- 利用規約に「著作権侵害目的での使用禁止」を明記

### サービスのフォーカス

- 機能が増えすぎると軸がぼやける可能性
- 「英語で表現する力」という軸を明確にしておく

## 優先度

現在のMVP（間違いノート等）を固めてから、次のフェーズで検討。

## 関連ファイル

- `src/components/ui/selection-popover.tsx`
- `src/components/writing/chat-panel.tsx`
- `src/lib/firestore.ts` - `saveVocab`
- `functions/src/index.ts` - `askFollowUp`
